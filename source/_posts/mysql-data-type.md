---
title: 【PHP面试题】请写出下面 MySQL 数据类型表达的意义（int(0)、char(16)、varchar(16)、datetime、text）。
top: false
cover: false
toc: true
mathjax: true
date: 2020-07-10 15:23:34
password:
summary:
tags:
    - MySQL
categories: MySQL
---
## 一、考点
### 1、MySQL数据类型
① 整型类型
TINYINT、SMALLINT、MEDIUMINT、INT、BIGINT
> - 属性：UNSIGNED（以上的类型，都可以配合 UNSIGNED 来使用，变成非负数。）
> - 长度：可以为整数类型指定宽度，例如：INT（11）、对大多数应用是没有意义的，它不会限制值得合法范围，只会影响 显示字符的个数。

```
int(3) : 代表如果存入的是 12，则会补个0，即012,
int(5) : 代表如果存入的是 12，则会补3个0，即00012，

注：此处的数字代表的是宽度。
```

② 实数类型
FLOAT、DOUBLE、DECIMAL

> - DECIMAL 可存储比 BIGINT还大的整数；可以用于存储精确的小数；
> - FLOAT 和 DOUBLE 类型支持使用标准的浮点进行近似计算。

③ 字符串类型
- VARCHAR
> - VARCHAR 类型用于存储可变长字符串，它比定长类型更节省空间；
> - VARCHAR 使用1或2个额外字节记录字符串的长度，列长度小于255字节，使用1个字节表示，否则用2个；
> - VARCHAR 长度，如果存储内容超出指定长度，会被截断；

- CHAR
> - CHAR 是定长的，根据定义的字符串长度分配足够的空间；
> - CHAR 会根据需要采用空格进行填充以方便比较；
> - CHAR 适合存储很短的字符串，或者所有值都接近同一个长度；
> - CHAR 长度，超出设定的长度，会被截断；
> - **对于经常变更的数据来说，CHAR 比 VARCHAR更好，CHAR不容易产生碎片；**
> - **对于非常短的列，CHAR 比 VARCHAR 在存储空间上更有效率；**
> - **只分配真正需要的空间，更长的列会消耗更多的内容；**
> - **尽量避免使用BLOB/TEXT类型，查询会使用临时表，导致严重的性能开销。**

④ 枚举

> - 有时可以使用枚举代替常用的字符串类型；
> - 把不重复的集合存储成一个预定义的集合（如：定义性别，用 enum，enum(‘男’，‘女’)）；
> - 非常紧凑，把列表值压缩到一个或两个字节；
> - 内部存储的是整数（如：enum（‘男’，‘女’），内部是0,1）；
> - 尽量避免使用数字作为 ENUM枚举 的常量，易混乱；
> - 排序是按照内部存储的整数进行排序；
> - 枚举表会使表的大小 大大减小 。

⑤ 日期和时间类型

> - 尽量使用 TIMESTAMP，比 DATETIME 空间效率高；
> - 用整数保存时间戳的格式通常不方便处理；
> - 如果需要存储微妙，可以使用 bigint 存储。

⑥ 列属性
```
auto_increment、default、not null、zerofill
```

### 2、延伸
#### 1） MySQL基础操作
常见操作
```
MySQL的连接和关闭：mysql -u(用户名) -p（密码） -h（主机） -P（端口）

其他：
\G; // 将打印结果垂直显示
\c; // 取消当前MySQL的命令
\q; // 退出MySQL
\s; // 显示MySQL的服务器状态 
\h; // 帮助信息
\d; // 改变执行服务（如：把 分号 改成其他符号）
```
#### 2） MySQL数据表引擎
**① InnoDB 表引擎【推荐使用】**

> - 默认事务型引擎，最重要最广泛的存储引擎，性能非常优秀；
> - 数据存储在共享表空间，可以通过配置分开；
> - 对主键查询的性能高于其他类型的存储引擎；
> - 内部做了很多优化，从磁盘读取数据时自动在内存构建 hash索引，插入数据时自动构建插入缓冲区；
> - 通过一些机制和工具支持真正的热备份；
> - 支持奔溃后的安全恢复；
> - 支持行级锁；
> - 支持外键。

**② MyISAM 表引擎**
> - 5.1版本前，MyISAM是默认的存储引擎；
> - 拥有全文索引、压缩、空间函数；
> - 不支持事务和行级锁，不支持崩溃后的安全恢复；
> - 表存储在两个文件 ，MYD 和 MYI（存储数据和索引）；
> - 设计简单，某些场景下性能很好

**③ 其他表引擎**
```
Archive
Blackhole
CSV
Memory
...
```
注：在进行 表引擎 选择的时候，优先选择 `InnoDB` ，它的性能十分得好。


#### 3） MySQL锁机制
**① 基础概念**
> 表锁是日常开发当中常见的问题，因此也是面试当中最常见的考察点，当多个查询同一个时刻进行数据修改时，就会产生并发控制的问题。
> 分为 `共享锁` 和 `排他锁` ，其实就是 `读锁` 和 `写锁` 。

**② 读锁**
> 共享的，不堵塞，多个用户可以同时读一个资源，互不干扰。

**③ 写锁**
> 排他锁，一个写锁会阻塞其他的写锁和读锁，这样可以只允许一个人进行写入，防止其他用户读取正在写入的资源。

使用场景：

> - 为了防止这条数据正在修改，然后有人过来访问的时候，以为这条数据就是最新数据；
> - 两个人都对同一条数据进行修改，防止把数据改乱。

**④ 锁粒度**
> - 表锁，系统性能开销最小，会锁定整张表，MyISAM使用表锁。
> - 行锁，最大程度地支持并发处理，但是也带来了最大的锁开销，InnoDB实现行级锁。


#### 4） MySQL事务处理、存储过程、触发器
**① 事务处理**
> - MySQL提供事务处理的表引擎，InnoDB；
> - 服务器层不管理事务，由下层的引擎实现，所以同一个事务中，使用多种存储引擎不靠谱（如：在操作两张表的时候，不能一张表用 MyISAM，另一张表用 InnoDB，这样对于事务操作是无法成功的，我们要求两张表都是 InnoDB）；
> - 在非事务的表上执行事务操作MySQL不会发出提醒，也不会报错（在做事务处理的时候，一定要检查我们的表引擎是否是 InnoDB）。

**② 存储过程**
- 为以后的使用而保存的一条或多条MySQL语句的集合（即把多条SQL语句保存在一个集合中）；
- 存储过程就是有业务逻辑和流程的集合；
- 可以在存储过程中创建表，更新数据，删除数据等等。

使用场景：

> - 通过把处理封装在容易使用的单元中，简化复杂得操作（如：在进行一个事务或者操作的时候，里面进行了上百条或者更多的SQL语句的操作，这个时候可以把它封装起来，别人想用的时候，直接让他拿过来用即可，不用再去写那么多条的SQL语句）;
> - 保证数据的一致性；
> - 简化对变动的管理。

**③ 触发器**
> 提供给程序员和数据分析员来保证数据完整性的一种方法，它是与表事件相关的特殊的存储过程。

使用场景：

- 可通过数据库中的相关表实现级联更改（如：改一张表，让其自动去改另一张表）；
- 实时监控某张表中的某个字段的更改而需要做出相应的处理；
- 某些业务编号的生成等。

注意事项：滥用会造成数据库及应用程序的维护困难。


## 二、解题方法
> 牢记以上基础知识点，理解数据类型 CHAR 和 VARCHAR 的差异，表存储引擎 InnoDB 和 MyISAM 的区别。


## 三、真题
### 1、请写出下面 MySQL 数据类型表达的意义（int(0)、char(16)、varchar(16)、datetime、text）。
> - int(0) : 整型，宽度为0位；
> - char(16)：定长字符串，字符串的宽度为16位；
> - varchar(16)：可变长度字符串，长度为16位；
> - datetime：时间日期；
> - text：存储字符串类型，存储一些大文本数据。

### 2、说明表存储引擎 InnoDB 和 MyISAM 的区别。
> - InnoDB 支持 行锁，MyISAM 支持 表锁；
> - InnoDB 支持 事务处理，MyISAM 不支持 事务处理；
> - InnoDB 默认 使用共享表空间，MyISAM 不使用共享表空间；
> - InnoDB 存储在 共享表空间，MyISAM的 数据保存在.MYI文件中，索引保存在.MYD的文件中。

### 3、MySQL中出现行锁、表锁，分别如何处理？